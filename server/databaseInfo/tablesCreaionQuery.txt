CREATE DATABASE plantea;

USE plantea;

CREATE TABLE categories(
    id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE plants(
	id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    latin_name TEXT,
    description TEXT,
    requirements TEXT,
    animal_safety_profile TEXT,
    care TEXT,
    watering TEXT,
    placement TEXT,
    category_id INT NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (category_id) REFERENCES categories(id)
);

CREATE TABLE plant_images(
	id INT NOT NULL AUTO_INCREMENT,
    url VARCHAR(255),
    plant_id INT NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY (plant_id) REFERENCES plants(id)
);

CREATE TABLE user_types(
	id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(30) NOT NULL UNIQUE,
    description VARCHAR(255),
    PRIMARY KEY(id)
);

CREATE TABLE users(
	id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    user_type_id INT NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY (user_type_id) REFERENCES user_types(id)
);

CREATE TABLE gardens(
	id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    user_id INT NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE favorites(
	id INT NOT NULL AUTO_INCREMENT,
    plant_id INT NOT NULL,
    user_id INT NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (plant_id) REFERENCES plants(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE user_plants(
	id INT NOT NULL AUTO_INCREMENT,
    user_id INT NOT NULL,
    plant_id INT NOT NULL,
    garden_id INT NOT NULL,
    custom_name VARCHAR(100) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(user_id) REFERENCES users(id),
    FOREIGN KEY(plant_id) REFERENCES plants(id),
    FOREIGN KEY(garden_id) REFERENCES gardens(id)
)

INSERT INTO user_types 
    (name, description)
VALUES 
    ('Admin', 'Admin user type - can do everything'),
    ('User', 'Normal user type - is being blocked after 7 days of free trial'),
    ('Premium', 'Premium user type which has access to all features');